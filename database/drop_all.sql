-- ============================================================================
-- 清理脚本：删除所有表、枚举、索引、扩展等
-- ============================================================================
-- 用于重新初始化数据库
-- 执行顺序：先执行此文件清理，再执行 schema.sql 创建表结构
-- ============================================================================

-- ============================================================================
-- 删除所有表（按依赖关系倒序，CASCADE 会自动删除依赖对象）
-- ============================================================================
DROP TABLE IF EXISTS audit_log CASCADE;
DROP TABLE IF EXISTS role_menus CASCADE;
DROP TABLE IF EXISTS menus CASCADE;
DROP TABLE IF EXISTS departments CASCADE;
DROP TABLE IF EXISTS role_permissions CASCADE;
DROP TABLE IF EXISTS permissions CASCADE;
DROP TABLE IF EXISTS user_roles CASCADE;
DROP TABLE IF EXISTS roles CASCADE;
DROP TABLE IF EXISTS users CASCADE;

-- ============================================================================
-- 删除枚举类型
-- ============================================================================
DROP TYPE IF EXISTS menu_type CASCADE;

-- ============================================================================
-- 删除扩展（可选，如果需要完全清理）
-- ============================================================================
-- DROP EXTENSION IF EXISTS citext CASCADE;

-- ============================================================================
-- 清理完成
-- ============================================================================
-- 注意：此脚本不会删除扩展 citext，因为可能被其他对象使用
-- 如果需要完全清理，请手动执行：DROP EXTENSION IF EXISTS citext CASCADE;
-- ============================================================================
